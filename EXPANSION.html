<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>North Carolina School Data Expansion Research • ncschooldata</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="North Carolina School Data Expansion Research"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ncschooldata</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/enrollment_hooks.html">15 Insights from North Carolina School Enrollment Data</a></li>
    <li><a class="dropdown-item" href="articles/northcarolina-assessment.html">North Carolina Assessment Data: 15 Stories from EOG and EOC Results</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/almartin82/ncschooldata" aria-label="GitHub"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>North Carolina School Data Expansion Research</h1>
      <small class="dont-index">Source: <a href="https://github.com/almartin82/ncschooldata/blob/main/EXPANSION.md" class="external-link"><code>EXPANSION.md</code></a></small>
    </div>

<div id="north-carolina-school-data-expansion-research" class="section level1">

<p><strong>Last Updated:</strong> 2026-01-04 <strong>Theme Researched:</strong> Graduation (Cohort Graduation Rates)</p>
<div class="section level2">
<h2 id="executive-summary">Executive Summary<a class="anchor" aria-label="anchor" href="#executive-summary"></a></h2>
<p>NC DPI provides comprehensive cohort graduation rate data through the “School Assessment and Other Indicator Data” Excel files. Data is available from 2020-21 through 2024-25 (and beyond as new years are released). The data includes 4-year and 5-year cohort graduation rates at state, LEA (district), and school levels, with breakdowns by 21 student subgroups.</p>
<p><strong>Recommendation:</strong> HIGH priority, MEDIUM complexity. Data is well-structured, consistent across years, and available via direct HTTP download.</p>
<hr></div>
<div class="section level2">
<h2 id="data-sources-found">Data Sources Found<a class="anchor" aria-label="anchor" href="#data-sources-found"></a></h2>
<div class="section level3">
<h3 id="source-1-school-assessment-and-other-indicator-data-primary">Source 1: School Assessment and Other Indicator Data (PRIMARY)<a class="anchor" aria-label="anchor" href="#source-1-school-assessment-and-other-indicator-data-primary"></a></h3>
<p><strong>Description:</strong> Annual Excel files containing accountability data including cohort graduation rates.</p>
<table class="table"><colgroup><col width="17%"><col width="14%"><col width="37%"><col width="31%"></colgroup><thead><tr class="header"><th>Year</th>
<th>URL</th>
<th>HTTP Status</th>
<th>File Size</th>
</tr></thead><tbody><tr class="odd"><td>2024-25</td>
<td><code>https://www.dpi.nc.gov/2024-25-school-assessment-and-other-indicator-data/open</code></td>
<td>200 OK</td>
<td>~112 MB</td>
</tr><tr class="even"><td>2023-24</td>
<td><code>https://www.dpi.nc.gov/2023-24-school-assessment-and-other-indicator-data/open</code></td>
<td>200 OK</td>
<td>~102 MB</td>
</tr><tr class="odd"><td>2022-23</td>
<td><code>https://www.dpi.nc.gov/2022-23-school-assessment-and-other-indicator-data/open</code></td>
<td>200 OK</td>
<td>~95 MB</td>
</tr><tr class="even"><td>2021-22</td>
<td><code>https://www.dpi.nc.gov/2021-22-school-assessment-and-other-indicator-data/open</code></td>
<td>200 OK</td>
<td>~93 MB</td>
</tr><tr class="odd"><td>2020-21</td>
<td><code>https://www.dpi.nc.gov/2020-21-school-assessment-and-other-indicator-data2/open</code></td>
<td>200 OK</td>
<td>~107 MB</td>
</tr><tr class="even"><td>2019-20</td>
<td><code>https://www.dpi.nc.gov/2019-20-school-assessment-and-other-indicator-data/open</code></td>
<td>404</td>
<td>N/A</td>
</tr><tr class="odd"><td>2018-19</td>
<td><code>https://www.dpi.nc.gov/2018-19-school-assessment-and-other-indicator-data/open</code></td>
<td>404</td>
<td>N/A</td>
</tr></tbody></table><p><strong>Notes:</strong> - 2020-21 uses alternate URL pattern (<code>*-data2</code> suffix) - Pre-2020 files return 404 - may need to search archive - URL pattern is NOT fully predictable - must enumerate each year</p>
<p><strong>Format:</strong> Excel (.xlsx) with multiple sheets <strong>Update Frequency:</strong> Annual (released September) <strong>Access Method:</strong> Direct HTTP download (no auth required)</p>
</div>
<div class="section level3">
<h3 id="source-2-school-report-card-data-set-alternative">Source 2: School Report Card Data Set (ALTERNATIVE)<a class="anchor" aria-label="anchor" href="#source-2-school-report-card-data-set-alternative"></a></h3>
<table class="table"><colgroup><col width="27%"><col width="13%"><col width="36%"><col width="22%"></colgroup><thead><tr class="header"><th>Resource</th>
<th>URL</th>
<th>HTTP Status</th>
<th>Format</th>
</tr></thead><tbody><tr class="odd"><td>SRC Data Set 2023-2024</td>
<td><code>https://www.dpi.nc.gov/src-data-set-2023-2024/open</code></td>
<td>200 OK</td>
<td>ZIP</td>
</tr><tr class="even"><td>SRC Data Dictionary</td>
<td><code>https://www.dpi.nc.gov/src-data-dictionary-2023-2024/open</code></td>
<td>200 OK</td>
<td>PDF/Excel</td>
</tr></tbody></table><p><strong>Notes:</strong> ZIP file contains comprehensive report card data. May include graduation rates but would need schema analysis.</p>
</div>
<div class="section level3">
<h3 id="source-3-tableau-dashboard-not-recommended">Source 3: Tableau Dashboard (NOT RECOMMENDED)<a class="anchor" aria-label="anchor" href="#source-3-tableau-dashboard-not-recommended"></a></h3>
<p><strong>URL:</strong> <code>https://go.ncdpi.gov/AccountabilityDashboards</code> <strong>Redirects to:</strong> <code>https://public.tableau.com/views/NCDPIAccountabilityLandingPage/</code></p>
<p><strong>Notes:</strong> JavaScript-based, no direct API access. Not suitable for programmatic data extraction.</p>
<hr></div>
</div>
<div class="section level2">
<h2 id="schema-analysis">Schema Analysis<a class="anchor" aria-label="anchor" href="#schema-analysis"></a></h2>
<div class="section level3">
<h3 id="sheet-structure-school-assessment-excel-files">Sheet Structure (School Assessment Excel Files)<a class="anchor" aria-label="anchor" href="#sheet-structure-school-assessment-excel-files"></a></h3>
<p>Each file contains the following relevant sheets: - <code>Other High Sch Ind</code> - Human-readable summary with graduation rates - <code>Assess-Ind Data Set</code> - Machine-readable raw data (PRIMARY for implementation) - <code>Asses-Ind Data Set Format</code> - Column definitions and code tables</p>
</div>
<div class="section level3">
<h3 id="column-names-assess-ind-data-set">Column Names (Assess-Ind Data Set)<a class="anchor" aria-label="anchor" href="#column-names-assess-ind-data-set"></a></h3>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Description</th>
<th>Example Values</th>
</tr></thead><tbody><tr class="odd"><td><code>reporting_year</code></td>
<td>YYYY format</td>
<td>“2025”</td>
</tr><tr class="even"><td><code>lea_code</code></td>
<td>3-character LEA code or “NC”</td>
<td>“010”, “920”, “NC”</td>
</tr><tr class="odd"><td><code>lea_name</code></td>
<td>District name</td>
<td>“Wake County Schools”</td>
</tr><tr class="even"><td><code>school_code</code></td>
<td>6-character school code or LEA code</td>
<td>“920358”, “NC”</td>
</tr><tr class="odd"><td><code>school_name</code></td>
<td>School name</td>
<td>“Athens Drive High”</td>
</tr><tr class="even"><td><code>sbe_region</code></td>
<td>State Board of Education region</td>
<td>numeric</td>
</tr><tr class="odd"><td><code>grade_span</code></td>
<td>Grade span of school</td>
<td>“09-12”</td>
</tr><tr class="even"><td><code>title_1</code></td>
<td>Title I served school</td>
<td>“Y” or NULL</td>
</tr><tr class="odd"><td><code>subgroup</code></td>
<td>Student subgroup code</td>
<td>“ALL”, “BLCK”, “EDS”</td>
</tr><tr class="even"><td><code>subject</code></td>
<td>Subject/indicator code</td>
<td>“CGRS”, “CGRE”</td>
</tr><tr class="odd"><td><code>den</code></td>
<td>Denominator (cohort size)</td>
<td>numeric</td>
</tr><tr class="even"><td><code>total_pct</code></td>
<td>Percentage or suppression marker</td>
<td>“87.7”, “&gt;95”, “&lt;5”</td>
</tr></tbody></table><p><strong>Schema Changes Noted:</strong></p>
<table class="table"><thead><tr class="header"><th>Year</th>
<th>Notes</th>
</tr></thead><tbody><tr class="odd"><td>2024-25</td>
<td>Added <code>missed_days</code> column (Hurricane Helene)</td>
</tr><tr class="even"><td>2023-24</td>
<td>Standard schema</td>
</tr><tr class="odd"><td>2022-23</td>
<td>Standard schema</td>
</tr><tr class="even"><td>2021-22</td>
<td>Requires <code>skip = 1</code> when reading (extra header row)</td>
</tr><tr class="odd"><td>2020-21</td>
<td>Different format sheet, different column order</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="subject-codes-for-graduation">Subject Codes for Graduation<a class="anchor" aria-label="anchor" href="#subject-codes-for-graduation"></a></h3>
<table class="table"><thead><tr class="header"><th>Code</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td><code>CGRS</code></td>
<td>Four-Year Cohort Graduation Rate (standard)</td>
</tr><tr class="even"><td><code>CGRE</code></td>
<td>Five-Year Cohort Graduation Rate (extended)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="subgroup-codes">Subgroup Codes<a class="anchor" aria-label="anchor" href="#subgroup-codes"></a></h3>
<table class="table"><thead><tr class="header"><th>Code</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td><code>ALL</code></td>
<td>All Students</td>
</tr><tr class="even"><td><code>AIG</code></td>
<td>Academically or Intellectually Gifted</td>
</tr><tr class="odd"><td><code>AMIN</code></td>
<td>American Indian</td>
</tr><tr class="even"><td><code>ASIA</code></td>
<td>Asian</td>
</tr><tr class="odd"><td><code>BLCK</code></td>
<td>Black</td>
</tr><tr class="even"><td><code>EDS</code></td>
<td>Economically Disadvantaged</td>
</tr><tr class="odd"><td><code>ELS</code></td>
<td>English Learners</td>
</tr><tr class="even"><td><code>FCS</code></td>
<td>Foster Care Students</td>
</tr><tr class="odd"><td><code>FEM</code></td>
<td>Female</td>
</tr><tr class="even"><td><code>HISP</code></td>
<td>Hispanic</td>
</tr><tr class="odd"><td><code>HMS</code></td>
<td>Homeless</td>
</tr><tr class="even"><td><code>MALE</code></td>
<td>Male</td>
</tr><tr class="odd"><td><code>MIG</code></td>
<td>Migrant</td>
</tr><tr class="even"><td><code>MIL</code></td>
<td>Military Connected</td>
</tr><tr class="odd"><td><code>MULT</code></td>
<td>Multiracial</td>
</tr><tr class="even"><td><code>NAIG</code></td>
<td>Not AIG</td>
</tr><tr class="odd"><td><code>NEDS</code></td>
<td>Not Economically Disadvantaged</td>
</tr><tr class="even"><td><code>NELS</code></td>
<td>Not English Learners</td>
</tr><tr class="odd"><td><code>NSWD</code></td>
<td>Not Students with Disabilities</td>
</tr><tr class="even"><td><code>SWD</code></td>
<td>Students with Disabilities</td>
</tr><tr class="odd"><td><code>WHTE</code></td>
<td>White</td>
</tr></tbody></table><hr></div>
</div>
<div class="section level2">
<h2 id="id-system">ID System<a class="anchor" aria-label="anchor" href="#id-system"></a></h2>
<div class="section level3">
<h3 id="lea-codes">LEA Codes<a class="anchor" aria-label="anchor" href="#lea-codes"></a></h3>
<ul><li>
<strong>Format:</strong> 3-character alphanumeric</li>
<li>
<strong>Examples:</strong> “010”, “020”, “920” (Wake County)</li>
<li>
<strong>State-level:</strong> Uses “NC”</li>
<li>
<strong>Count:</strong> ~200+ LEAs (traditional districts + charters)</li>
</ul></div>
<div class="section level3">
<h3 id="school-codes">School Codes<a class="anchor" aria-label="anchor" href="#school-codes"></a></h3>
<ul><li>
<strong>Format:</strong> 6-character alphanumeric</li>
<li>
<strong>Structure:</strong> <code>{LEA_CODE}{SCHOOL_NUM}</code> (3-digit LEA + 3-digit school)</li>
<li>
<strong>Examples:</strong> “920358” (Athens Drive High in Wake County)</li>
<li>
<strong>LEA-level data:</strong> Uses LEA code as school_code</li>
</ul></div>
<div class="section level3">
<h3 id="data-hierarchy">Data Hierarchy<a class="anchor" aria-label="anchor" href="#data-hierarchy"></a></h3>
<pre><code>State (lea_code = "NC", school_code = "NC")
  |
  +-- LEA (lea_code = "920", school_code = "920")
        |
        +-- School (lea_code = "920", school_code = "920358")</code></pre>
<hr></div>
</div>
<div class="section level2">
<h2 id="time-series-heuristics">Time Series Heuristics<a class="anchor" aria-label="anchor" href="#time-series-heuristics"></a></h2>
<div class="section level3">
<h3 id="state-level-4-year-graduation-rate">State-Level 4-Year Graduation Rate<a class="anchor" aria-label="anchor" href="#state-level-4-year-graduation-rate"></a></h3>
<table class="table"><thead><tr class="header"><th>Year</th>
<th>Rate</th>
<th>YoY Change</th>
</tr></thead><tbody><tr class="odd"><td>2024-25</td>
<td>87.7%</td>
<td>+0.8%</td>
</tr><tr class="even"><td>2023-24</td>
<td>87.0%</td>
<td>+0.7%</td>
</tr><tr class="odd"><td>2022-23</td>
<td>86.3%</td>
<td>-0.1%</td>
</tr><tr class="even"><td>2021-22</td>
<td>86.4%</td>
<td>+0.4%</td>
</tr><tr class="odd"><td>2020-21</td>
<td>86.0%</td>
<td>(baseline)</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="expected-ranges">Expected Ranges<a class="anchor" aria-label="anchor" href="#expected-ranges"></a></h3>
<table class="table"><thead><tr class="header"><th>Metric</th>
<th>Expected Range</th>
<th>Red Flag If</th>
</tr></thead><tbody><tr class="odd"><td>State 4-year rate</td>
<td>85% - 92%</td>
<td>Change &gt; 2% YoY</td>
</tr><tr class="even"><td>School 4-year rate</td>
<td>14% - &gt;95%</td>
<td>Below 10%</td>
</tr><tr class="odd"><td>Cohort size (state)</td>
<td>120,000 - 130,000</td>
<td>Change &gt; 10% YoY</td>
</tr><tr class="even"><td>Schools with data</td>
<td>650 - 750</td>
<td>Drop &gt; 50 schools</td>
</tr></tbody></table></div>
<div class="section level3">
<h3 id="suppression-rules">Suppression Rules<a class="anchor" aria-label="anchor" href="#suppression-rules"></a></h3>
<ul><li>
<code>&gt;95</code> indicates rate above 95% (small denominator suppression)</li>
<li>
<code>&lt;5</code> indicates rate below 5% (small denominator suppression)</li>
<li>Both should be handled as NA or estimated bounds</li>
</ul><hr></div>
</div>
<div class="section level2">
<h2 id="known-data-issues">Known Data Issues<a class="anchor" aria-label="anchor" href="#known-data-issues"></a></h2>
<table class="table"><colgroup><col width="23%"><col width="43%"><col width="33%"></colgroup><thead><tr class="header"><th>Issue</th>
<th>Description</th>
<th>Handling</th>
</tr></thead><tbody><tr class="odd"><td>Suppression markers</td>
<td>“&gt;95” and “&lt;5” in total_pct</td>
<td>Parse as NA or bounds</td>
</tr><tr class="even"><td>Floating point errors</td>
<td>“68.900000000000006”</td>
<td>Round to reasonable precision</td>
</tr><tr class="odd"><td>Schema variation</td>
<td>2021-22 needs skip=1</td>
<td>Detect by checking first row</td>
</tr><tr class="even"><td>COVID impact</td>
<td>2020-21 had no accountability growth</td>
<td>Document in metadata</td>
</tr><tr class="odd"><td>Hurricane Helene</td>
<td>2024-25 has <code>missed_days</code> column</td>
<td>Handle as optional column</td>
</tr></tbody></table><hr></div>
<div class="section level2">
<h2 id="recommended-implementation">Recommended Implementation<a class="anchor" aria-label="anchor" href="#recommended-implementation"></a></h2>
<div class="section level3">
<h3 id="priority-high">Priority: HIGH<a class="anchor" aria-label="anchor" href="#priority-high"></a></h3>
<ul><li>Clean, structured data source</li>
<li>Consistent annual updates</li>
<li>Critical metric for education research</li>
</ul></div>
<div class="section level3">
<h3 id="complexity-medium">Complexity: MEDIUM<a class="anchor" aria-label="anchor" href="#complexity-medium"></a></h3>
<ul><li>Schema variations require year-detection logic</li>
<li>Multiple subgroups to handle</li>
<li>Suppression markers need parsing</li>
</ul></div>
<div class="section level3">
<h3 id="estimated-files-to-modify">Estimated Files to Modify<a class="anchor" aria-label="anchor" href="#estimated-files-to-modify"></a></h3>
<ol style="list-style-type: decimal"><li>
<code>R/get_raw_graduation.R</code> - New file for data download</li>
<li>
<code>R/process_graduation.R</code> - New file for schema normalization</li>
<li>
<code>R/tidy_graduation.R</code> - New file for long format transformation</li>
<li>
<code>R/fetch_graduation.R</code> - New file for user-facing API</li>
<li>
<code>DESCRIPTION</code> - No new dependencies needed</li>
<li>
<code>tests/testthat/test-pipeline-graduation-live.R</code> - Live tests</li>
</ol></div>
<div class="section level3">
<h3 id="implementation-steps">Implementation Steps<a class="anchor" aria-label="anchor" href="#implementation-steps"></a></h3>
<ol style="list-style-type: decimal"><li>Create <code>get_raw_grad()</code> function:
<ul><li>Build URL for each year (handle inconsistent patterns)</li>
<li>Download Excel file to temp location</li>
<li>Read “Assess-Ind Data Set” sheet with appropriate skip</li>
<li>Filter to CGRS/CGRE subjects only</li>
<li>Return raw data frame</li>
</ul></li>
<li>Create <code>process_grad()</code> function:
<ul><li>Standardize column names across years</li>
<li>Parse suppression markers (“&gt;95” -&gt; NA with flag)</li>
<li>Convert numeric fields</li>
<li>Add <code>end_year</code> column</li>
</ul></li>
<li>Create <code>tidy_grad()</code> function:
<ul><li>Keep long format (already long)</li>
<li>Rename columns to standard names:
<ul><li>
<code>grad_rate_pct</code> from <code>total_pct</code>
</li>
<li>
<code>cohort_size</code> from <code>den</code>
</li>
<li>
<code>rate_type</code> from <code>subject</code> (4yr/5yr)</li>
</ul></li>
<li>Add <code>is_state</code>, <code>is_lea</code>, <code>is_school</code> flags</li>
</ul></li>
<li>Create <code>fetch_grad()</code> user API:
<ul><li>Parameters: <code>end_year</code>, <code>tidy = TRUE</code>, <code>use_cache = TRUE</code>
</li>
<li>Support <code>fetch_grad_multi()</code> for multiple years</li>
</ul></li>
</ol><hr></div>
</div>
<div class="section level2">
<h2 id="test-requirements">Test Requirements<a class="anchor" aria-label="anchor" href="#test-requirements"></a></h2>
<div class="section level3">
<h3 id="raw-data-fidelity-tests-needed">Raw Data Fidelity Tests Needed<a class="anchor" aria-label="anchor" href="#raw-data-fidelity-tests-needed"></a></h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"2024-25: State 4-year rate matches raw Excel"</span>, <span class="op">{</span></span>
<span>  <span class="co"># Raw value from Excel: 87.7%</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch_grad</span><span class="op">(</span><span class="fl">2025</span>, tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">state_rate</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">is_state</span>, <span class="va">subgroup</span> <span class="op">==</span> <span class="st">"ALL"</span>, <span class="va">rate_type</span> <span class="op">==</span> <span class="st">"4yr"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pull</span><span class="op">(</span><span class="va">grad_rate_pct</span><span class="op">)</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="va">state_rate</span>, <span class="fl">87.7</span>, tolerance <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"2024-25: Wake County 4-year rate matches raw Excel"</span>, <span class="op">{</span></span>
<span>  <span class="co"># Raw value from Excel: need to verify</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch_grad</span><span class="op">(</span><span class="fl">2025</span>, tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">wake_rate</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">lea_code</span> <span class="op">==</span> <span class="st">"920"</span>, <span class="va">school_code</span> <span class="op">==</span> <span class="st">"920"</span>,</span>
<span>           <span class="va">subgroup</span> <span class="op">==</span> <span class="st">"ALL"</span>, <span class="va">rate_type</span> <span class="op">==</span> <span class="st">"4yr"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pull</span><span class="op">(</span><span class="va">grad_rate_pct</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">wake_rate</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="va">wake_rate</span> <span class="op">&gt;</span> <span class="fl">80</span> <span class="op">&amp;</span> <span class="va">wake_rate</span> <span class="op">&lt;</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-quality-checks">Data Quality Checks<a class="anchor" aria-label="anchor" href="#data-quality-checks"></a></h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"No negative graduation rates"</span>, <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch_grad</span><span class="op">(</span><span class="fl">2025</span>, tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">grad_rate_pct</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">grad_rate_pct</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"All rates &lt;= 100%"</span>, <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch_grad</span><span class="op">(</span><span class="fl">2025</span>, tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">grad_rate_pct</span> <span class="op">&lt;=</span> <span class="fl">100</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">grad_rate_pct</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"All subgroups present at state level"</span>, <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch_grad</span><span class="op">(</span><span class="fl">2025</span>, tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">state_subgroups</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">is_state</span>, <span class="va">rate_type</span> <span class="op">==</span> <span class="st">"4yr"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pull</span><span class="op">(</span><span class="va">subgroup</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">state_subgroups</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"State rate in expected range"</span>, <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">fetch_grad</span><span class="op">(</span><span class="fl">2025</span>, tidy <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">state_rate</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">is_state</span>, <span class="va">subgroup</span> <span class="op">==</span> <span class="st">"ALL"</span>, <span class="va">rate_type</span> <span class="op">==</span> <span class="st">"4yr"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pull</span><span class="op">(</span><span class="va">grad_rate_pct</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="va">state_rate</span> <span class="op">&gt;</span> <span class="fl">85</span> <span class="op">&amp;</span> <span class="va">state_rate</span> <span class="op">&lt;</span> <span class="fl">92</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pipeline-tests">Pipeline Tests<a class="anchor" aria-label="anchor" href="#pipeline-tests"></a></h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"URL returns HTTP 200"</span>, <span class="op">{</span></span>
<span>  <span class="fu">skip_if_offline</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://www.dpi.nc.gov/2024-25-school-assessment-and-other-indicator-data/open"</span></span>
<span>  <span class="va">response</span> <span class="op">&lt;-</span> <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/HEAD.html" class="external-link">HEAD</a></span><span class="op">(</span><span class="va">url</span>, <span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/timeout.html" class="external-link">timeout</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu">expect_equal</span><span class="op">(</span><span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/status_code.html" class="external-link">status_code</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span>, <span class="fl">200</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">test_that</span><span class="op">(</span><span class="st">"Downloaded file is valid Excel"</span>, <span class="op">{</span></span>
<span>  <span class="fu">skip_if_offline</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".xlsx"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">url</span>, <span class="va">temp</span>, mode <span class="op">=</span> <span class="st">"wb"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">sheets</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html" class="external-link">excel_sheets</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span>  <span class="fu">expect_true</span><span class="op">(</span><span class="st">"Assess-Ind Data Set"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sheets</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="data-source-urls-summary">Data Source URLs Summary<a class="anchor" aria-label="anchor" href="#data-source-urls-summary"></a></h2>
<div class="section level3">
<h3 id="working-urls-verified-2026-01-04">Working URLs (Verified 2026-01-04)<a class="anchor" aria-label="anchor" href="#working-urls-verified-2026-01-04"></a></h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># URL pattern function (note: not fully predictable!)</span></span>
<span><span class="va">get_grad_url</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">end_year</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">urls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"2025"</span> <span class="op">=</span> <span class="st">"https://www.dpi.nc.gov/2024-25-school-assessment-and-other-indicator-data/open"</span>,</span>
<span>    <span class="st">"2024"</span> <span class="op">=</span> <span class="st">"https://www.dpi.nc.gov/2023-24-school-assessment-and-other-indicator-data/open"</span>,</span>
<span>    <span class="st">"2023"</span> <span class="op">=</span> <span class="st">"https://www.dpi.nc.gov/2022-23-school-assessment-and-other-indicator-data/open"</span>,</span>
<span>    <span class="st">"2022"</span> <span class="op">=</span> <span class="st">"https://www.dpi.nc.gov/2021-22-school-assessment-and-other-indicator-data/open"</span>,</span>
<span>    <span class="st">"2021"</span> <span class="op">=</span> <span class="st">"https://www.dpi.nc.gov/2020-21-school-assessment-and-other-indicator-data2/open"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">urls</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">end_year</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="schema-detection">Schema Detection<a class="anchor" aria-label="anchor" href="#schema-detection"></a></h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Detect if file needs skip parameter</span></span>
<span><span class="va">needs_skip</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">first_row</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_excel</a></span><span class="op">(</span><span class="va">file_path</span>, sheet <span class="op">=</span> <span class="st">"Assess-Ind Data Set"</span>, n_max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co"># If first column is "Back to Introduction", need skip = 1</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Back to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">first_row</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<hr></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
<ul><li><a href="https://www.dpi.nc.gov/districts-schools/accountability-and-testing/school-accountability-and-reporting/cohort-graduation-rates" class="external-link">NC DPI Cohort Graduation Rates</a></li>
<li><a href="https://www.dpi.nc.gov/districts-schools/accountability-and-testing/school-accountability-and-reporting/accountability-data-sets-and-reports" class="external-link">Accountability Data Sets and Reports</a></li>
<li><a href="https://www.dpi.nc.gov/districts-schools/accountability-and-testing/school-accountability-and-reporting/accountability-data-sets-and-reports/accountability-report-archive" class="external-link">Accountability Report Archive</a></li>
<li><a href="https://www.dpi.nc.gov/2024-25-cohort-graduation-rate/download?attachment=" class="external-link">2024-25 Cohort Graduation Rate Manual (PDF)</a></li>
</ul></div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Al Martin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

